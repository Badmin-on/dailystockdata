# ğŸ“Š YoonStock Pro - ì „ë¬¸ ê°œë°œì ì¢…í•© ë¶„ì„ ë° ê°œì„  ê³„íšì„œ

**ì‘ì„±ì¼**: 2025-10-25  
**í”„ë¡œì íŠ¸**: YoonStock Pro (dailystockdata.vercel.app)  
**GitHub**: https://github.com/Badmin-on/dailystockdata  
**ì‘ì„±ì**: ì „ë¬¸ ê°œë°œì ë¶„ì„íŒ€

---

## ğŸ¯ Executive Summary (ê²½ì˜ì§„ ìš”ì•½)

### í˜„ì¬ ìƒíƒœ
- âœ… **ê¸°ì—… ë°ì´í„°**: 1,788ê°œ ê¸°ì—… (KOSPI + KOSDAQ)
- âœ… **ì¬ë¬´ ë°ì´í„°**: 135,241ê±´ (4ê°œë…„ ë°ì´í„°, 100% ì™„ë£Œ)
- âš ï¸ **ì£¼ê°€ ë°ì´í„°**: 32,425ê±´ (19ê°œ ê¸°ì—…ë§Œ, 1.1% ì»¤ë²„ë¦¬ì§€)
- âŒ **120ì¼ ì´í‰ì„ **: 0.8%ë§Œ ë¶„ì„ ê°€ëŠ¥

### í•µì‹¬ ë¬¸ì œ
**ì£¼ê°€ ë°ì´í„°ê°€ 99%ì˜ ê¸°ì—…ì—ì„œ ëˆ„ë½ë˜ì–´ íˆ¬ì ê¸°íšŒ ë¶„ì„ ì‹œìŠ¤í…œì´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

### í•´ê²° ë°©ì•ˆ
- **Phase 1 (1-2ì¼)**: ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ â†’ ì¦‰ì‹œ ì„œë¹„ìŠ¤ ë¡ ì¹­ ê°€ëŠ¥
- **Phase 2 (1ì£¼)**: ë°ì´í„° ì •í™•ì„± ê²€ì¦
- **Phase 3 (2ì£¼)**: UI/UX ëŒ€ëŒ€ì  ê°œì„  (ì‚¬ì´ë“œë°”, í•„í„°ë§, ì°¨íŠ¸)
- **Phase 4-5 (2ì£¼)**: ë°±ì—”ë“œ ìµœì í™” ë° í”„ë¡œë•ì…˜ ë°°í¬

---

## ğŸ“‹ ëª©ì°¨

1. [í˜„ì¬ ì‹œìŠ¤í…œ êµ¬ì¡° ìƒì„¸ ë¶„ì„](#1-í˜„ì¬-ì‹œìŠ¤í…œ-êµ¬ì¡°-ìƒì„¸-ë¶„ì„)
2. [ë°ì´í„° ìˆ˜ì§‘ ë¡œì§ ë¶„ì„](#2-ë°ì´í„°-ìˆ˜ì§‘-ë¡œì§-ë¶„ì„)
3. [ë°ì´í„° ì €ì¥ ìœ„ì¹˜ ë° í˜•ì‹](#3-ë°ì´í„°-ì €ì¥-ìœ„ì¹˜-ë°-í˜•ì‹)
4. [UI/UX êµ¬ì¡° ë° ì‚¬ìš©ì ê²½í—˜](#4-uiux-êµ¬ì¡°-ë°-ì‚¬ìš©ì-ê²½í—˜)
5. [í•µì‹¬ ë¬¸ì œì  ë° í•´ê²° ë°©ì•ˆ](#5-í•µì‹¬-ë¬¸ì œì -ë°-í•´ê²°-ë°©ì•ˆ)
6. [ë‹¨ê³„ë³„ ê°œì„  ì‹¤í–‰ ê³„íš](#6-ë‹¨ê³„ë³„-ê°œì„ -ì‹¤í–‰-ê³„íš)

---

## 1. í˜„ì¬ ì‹œìŠ¤í…œ êµ¬ì¡° ìƒì„¸ ë¶„ì„

### 1.1 ê¸°ìˆ  ìŠ¤íƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Frontend Layer                        â”‚
â”‚  Next.js 15 (App Router)                               â”‚
â”‚  React 19                                              â”‚
â”‚  TypeScript 5.9                                        â”‚
â”‚  Tailwind CSS 3.4                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   API Layer                             â”‚
â”‚  Next.js API Routes (13ê°œ ì—”ë“œí¬ì¸íŠ¸)                   â”‚
â”‚  - ì¬ë¬´ ë°ì´í„° ìˆ˜ì§‘ (Cron)                              â”‚
â”‚  - ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ (Cron)                              â”‚
â”‚  - íˆ¬ì ê¸°íšŒ ë¶„ì„                                       â”‚
â”‚  - ë°ì´í„° ìƒíƒœ ëª¨ë‹ˆí„°ë§                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Database Layer                          â”‚
â”‚  Supabase (PostgreSQL 15)                              â”‚
â”‚  - 3ê°œ í•µì‹¬ í…Œì´ë¸”                                      â”‚
â”‚  - 3ê°œ ë¶„ì„ ë·° (Materialized Views)                    â”‚
â”‚  - Region: Northeast Asia (Seoul)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
webapp/
â”œâ”€â”€ app/                          # Next.js 15 App Router
â”‚   â”œâ”€â”€ api/                      # API ì—”ë“œí¬ì¸íŠ¸ (13ê°œ)
â”‚   â”‚   â”œâ”€â”€ available-years/      # ì‚¬ìš© ê°€ëŠ¥í•œ ì—°ë„ ëª©ë¡
â”‚   â”‚   â”œâ”€â”€ collect-data/         # ì¬ë¬´ ë°ì´í„° ìˆ˜ì§‘ (Cron)
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts          # ë©”ì¸ Cron Job
â”‚   â”‚   â”‚   â””â”€â”€ manual/           # ìˆ˜ë™ í…ŒìŠ¤íŠ¸ (5ê°œ ê¸°ì—…)
â”‚   â”‚   â”œâ”€â”€ collect-stock-prices/ # ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ (Cron)
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts          # ë©”ì¸ Cron Job
â”‚   â”‚   â”‚   â”œâ”€â”€ manual/           # ìˆ˜ë™ í…ŒìŠ¤íŠ¸ (5ê°œ ê¸°ì—…)
â”‚   â”‚   â”‚   â””â”€â”€ batch/            # ë°°ì¹˜ ìˆ˜ì§‘ (100ê°œì”©)
â”‚   â”‚   â”œâ”€â”€ consensus-changes/    # ì¬ë¬´ ì»¨ì„¼ì„œìŠ¤ ë³€í™” ë¶„ì„
â”‚   â”‚   â”œâ”€â”€ data-status/          # ë°ì´í„° ìˆ˜ì§‘ í˜„í™© ëŒ€ì‹œë³´ë“œ
â”‚   â”‚   â”œâ”€â”€ investment-opportunities/ # íˆ¬ì ê¸°íšŒ ë¶„ì„
â”‚   â”‚   â”œâ”€â”€ refresh-views/        # Materialized View ê°±ì‹ 
â”‚   â”‚   â”œâ”€â”€ stock-analysis/       # 120ì¼ ì´í‰ì„  ë¶„ì„
â”‚   â”‚   â”œâ”€â”€ stock-comparison/     # ê¸°ì—…ê°„ ì¬ë¬´ ë¹„êµ
â”‚   â”‚   â””â”€â”€ test-db/              # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ dashboard/                # ì¬ë¬´ì œí‘œ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€
â”‚   â”œâ”€â”€ monitor/                  # ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ â­ í•µì‹¬
â”‚   â”œâ”€â”€ opportunities/            # íˆ¬ìê¸°íšŒ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€
â”‚   â”œâ”€â”€ layout.tsx                # ì „ì—­ ë ˆì´ì•„ì›ƒ
â”‚   â””â”€â”€ page.tsx                  # í™ˆí˜ì´ì§€
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase.ts               # Supabase í´ë¼ì´ì–¸íŠ¸ (Anon + Admin)
â”‚   â””â”€â”€ scraper.ts                # ë°ì´í„° ìŠ¤í¬ë˜í•‘ ë¡œì§
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ schema.sql                # ê¸°ë³¸ DB ìŠ¤í‚¤ë§ˆ
â”‚   â”œâ”€â”€ schema-enhancement-final.sql # ê³ ê¸‰ ë¶„ì„ ë·°
â”‚   â”œâ”€â”€ collect-all-batches.sh    # ë°°ì¹˜ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ ...
â”œâ”€â”€ package.json                  # ì˜ì¡´ì„± ê´€ë¦¬
â”œâ”€â”€ vercel.json                   # Vercel Cron ì„¤ì •
â””â”€â”€ .env.local                    # í™˜ê²½ë³€ìˆ˜ (ë¡œì»¬)
```

### 1.3 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

#### í•µì‹¬ í…Œì´ë¸” (3ê°œ)

```sql
-- 1. companies (ê¸°ì—… ì •ë³´)
CREATE TABLE companies (
  id BIGSERIAL PRIMARY KEY,
  name TEXT NOT NULL,
  code TEXT UNIQUE NOT NULL,  -- ì¢…ëª©ì½”ë“œ (ì˜ˆ: 005930)
  market TEXT NOT NULL,        -- KOSPI ë˜ëŠ” KOSDAQ
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- 2. financial_data (ì¬ë¬´ ë°ì´í„°)
CREATE TABLE financial_data (
  id BIGSERIAL PRIMARY KEY,
  company_id BIGINT REFERENCES companies(id) ON DELETE CASCADE,
  year INTEGER NOT NULL,
  scrape_date DATE NOT NULL,
  revenue BIGINT,              -- ë§¤ì¶œì•¡ (ì› ë‹¨ìœ„)
  operating_profit BIGINT,     -- ì˜ì—…ì´ìµ (ì› ë‹¨ìœ„)
  is_estimate BOOLEAN DEFAULT FALSE,  -- ì¶”ì •ì¹˜ ì—¬ë¶€
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(company_id, year, scrape_date)
);

-- 3. daily_stock_prices (ì¼ì¼ ì£¼ê°€)
CREATE TABLE daily_stock_prices (
  id BIGSERIAL PRIMARY KEY,
  company_id BIGINT REFERENCES companies(id) ON DELETE CASCADE,
  date DATE NOT NULL,
  close_price DECIMAL(15,2),   -- ì¢…ê°€
  change_rate DECIMAL(8,4),    -- ë³€ë™ë¥  (%)
  volume BIGINT,               -- ê±°ë˜ëŸ‰
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(company_id, date)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_companies_code ON companies(code);
CREATE INDEX idx_companies_market ON companies(market);
CREATE INDEX idx_financial_company_year ON financial_data(company_id, year);
CREATE INDEX idx_financial_scrape_date ON financial_data(scrape_date);
CREATE INDEX idx_prices_company_date ON daily_stock_prices(company_id, date);
CREATE INDEX idx_prices_date ON daily_stock_prices(date);
```

#### ë¶„ì„ ë·° (3ê°œ)

```sql
-- 1. mv_consensus_changes (Materialized View)
-- ì¬ë¬´ ì»¨ì„¼ì„œìŠ¤ ë³€í™”ìœ¨ ê³„ì‚°
CREATE MATERIALIZED VIEW mv_consensus_changes AS
SELECT 
  c.id AS company_id,
  c.name,
  c.code,
  c.market,
  -- ì „ì¼ ëŒ€ë¹„ ë³€í™”ìœ¨
  (fd.revenue - lag_1d.revenue) / NULLIF(lag_1d.revenue, 0) * 100 AS revenue_change_1d,
  (fd.operating_profit - lag_1d.operating_profit) / NULLIF(lag_1d.operating_profit, 0) * 100 AS op_profit_change_1d,
  -- 1ê°œì›” ì „ ëŒ€ë¹„
  (fd.revenue - lag_1m.revenue) / NULLIF(lag_1m.revenue, 0) * 100 AS revenue_change_1m,
  (fd.operating_profit - lag_1m.operating_profit) / NULLIF(lag_1m.operating_profit, 0) * 100 AS op_profit_change_1m,
  -- 3ê°œì›” ì „ ëŒ€ë¹„
  (fd.revenue - lag_3m.revenue) / NULLIF(lag_3m.revenue, 0) * 100 AS revenue_change_3m,
  (fd.operating_profit - lag_3m.operating_profit) / NULLIF(lag_3m.operating_profit, 0) * 100 AS op_profit_change_3m,
  -- 1ë…„ ì „ ëŒ€ë¹„
  (fd.revenue - lag_1y.revenue) / NULLIF(lag_1y.revenue, 0) * 100 AS revenue_change_1y,
  (fd.operating_profit - lag_1y.operating_profit) / NULLIF(lag_1y.operating_profit, 0) * 100 AS op_profit_change_1y
FROM companies c
-- (JOIN ë¡œì§ ìƒëµ)
;

-- 2. mv_stock_analysis (Materialized View)
-- 120ì¼ ì´ë™í‰ê· ì„  ë° ì´ê²©ë„ ë¶„ì„
CREATE MATERIALIZED VIEW mv_stock_analysis AS
SELECT 
  c.id AS company_id,
  c.name,
  c.code,
  c.market,
  dsp.close_price AS current_price,
  dsp.date AS price_date,
  AVG(dsp2.close_price) OVER (
    PARTITION BY c.id 
    ORDER BY dsp.date 
    ROWS BETWEEN 119 PRECEDING AND CURRENT ROW
  ) AS ma_120,
  (dsp.close_price - ma_120) / NULLIF(ma_120, 0) * 100 AS divergence_120,
  -- 52ì£¼ ìµœê³ /ìµœì €ê°€
  MAX(dsp2.close_price) OVER (PARTITION BY c.id) AS week_52_high,
  MIN(dsp2.close_price) OVER (PARTITION BY c.id) AS week_52_low
FROM companies c
-- (JOIN ë¡œì§ ìƒëµ)
;

-- 3. v_investment_opportunities (View)
-- íˆ¬ì ì ìˆ˜ ê³„ì‚° (ì»¨ì„¼ì„œìŠ¤ 60% + ì´ê²©ë„ 40%)
CREATE VIEW v_investment_opportunities AS
SELECT 
  c.id AS company_id,
  c.name,
  c.code,
  c.market,
  -- ì»¨ì„¼ì„œìŠ¤ ì ìˆ˜ (0-100ì )
  GREATEST(0, LEAST(100, 
    (cc.revenue_change_1m * 0.3 + cc.op_profit_change_1m * 0.7) * 2
  )) AS consensus_score,
  -- ì´ê²©ë„ ì ìˆ˜ (0-100ì )
  CASE 
    WHEN sa.divergence_120 < -10 THEN 100
    WHEN sa.divergence_120 < 0 THEN 80
    WHEN sa.divergence_120 < 5 THEN 60
    WHEN sa.divergence_120 < 15 THEN 40
    ELSE 20
  END AS divergence_score,
  -- íˆ¬ì ì ìˆ˜ (ê°€ì¤‘ í‰ê· )
  (consensus_score * 0.6 + divergence_score * 0.4) AS investment_score,
  -- íˆ¬ì ë“±ê¸‰
  CASE 
    WHEN investment_score >= 80 THEN 'Sê¸‰'
    WHEN investment_score >= 70 THEN 'Aê¸‰'
    WHEN investment_score >= 60 THEN 'Bê¸‰'
    WHEN investment_score >= 50 THEN 'Cê¸‰'
    ELSE 'Dê¸‰'
  END AS investment_grade,
  -- ì¶”ê°€ ì •ë³´
  sa.current_price,
  sa.ma_120,
  sa.divergence_120,
  cc.revenue_change_1m,
  cc.op_profit_change_1m
FROM companies c
LEFT JOIN mv_consensus_changes cc ON c.id = cc.company_id
LEFT JOIN mv_stock_analysis sa ON c.id = sa.company_id
;
```

### 1.4 API ì—”ë“œí¬ì¸íŠ¸ ìƒì„¸

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ìš©ë„ | Cron | ì„¤ëª… |
|-----------|--------|------|------|------|
| `/api/collect-data` | GET | ì¬ë¬´ ë°ì´í„° ìˆ˜ì§‘ | âœ… í‰ì¼ 08:00 | FnGuide ì»¨ì„¼ì„œìŠ¤ ìˆ˜ì§‘ |
| `/api/collect-data/manual` | GET | ì¬ë¬´ ë°ì´í„° í…ŒìŠ¤íŠ¸ | âŒ | 5ê°œ ê¸°ì—…ë§Œ ìˆ˜ì§‘ |
| `/api/collect-stock-prices` | GET | ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ | âœ… í‰ì¼ 20:00 | 120ì¼ì¹˜ ì£¼ê°€ ìˆ˜ì§‘ |
| `/api/collect-stock-prices/manual` | GET | ì£¼ê°€ ë°ì´í„° í…ŒìŠ¤íŠ¸ | âŒ | 5ê°œ ê¸°ì—…ë§Œ ìˆ˜ì§‘ |
| `/api/collect-stock-prices/batch` | GET | ë°°ì¹˜ ì£¼ê°€ ìˆ˜ì§‘ | âŒ | 100ê°œì”© ë°°ì¹˜ ìˆ˜ì§‘ |
| `/api/consensus-changes` | GET | ì»¨ì„¼ì„œìŠ¤ ë³€í™” ì¡°íšŒ | âŒ | ì¬ë¬´ ë³€í™”ìœ¨ ë¶„ì„ |
| `/api/stock-analysis` | GET | ì£¼ê°€ ì´ê²©ë„ ì¡°íšŒ | âŒ | 120ì¼ ì´í‰ì„  ë¶„ì„ |
| `/api/investment-opportunities` | GET | íˆ¬ì ê¸°íšŒ ì¡°íšŒ | âŒ | S/A/B/C/D ë“±ê¸‰ í•„í„°ë§ |
| `/api/refresh-views` | POST | View ê°±ì‹  | âŒ | Materialized View ìƒˆë¡œê³ ì¹¨ |
| `/api/data-status` | GET | ë°ì´í„° í˜„í™© ì¡°íšŒ | âŒ | ìˆ˜ì§‘ ìƒíƒœ ëª¨ë‹ˆí„°ë§ |
| `/api/stock-comparison` | GET | ê¸°ì—… ë¹„êµ | âŒ | ì¬ë¬´ì œí‘œ ë¹„êµ |
| `/api/available-years` | GET | ì—°ë„ ëª©ë¡ | âŒ | ì‚¬ìš© ê°€ëŠ¥í•œ ì—°ë„ |
| `/api/test-db` | GET | DB ì—°ê²° í…ŒìŠ¤íŠ¸ | âŒ | Supabase ì—°ê²° í™•ì¸ |

---

## 2. ë°ì´í„° ìˆ˜ì§‘ ë¡œì§ ë¶„ì„

### 2.1 ì¬ë¬´ ë°ì´í„° ìˆ˜ì§‘ (FnGuide ê¸°ë°˜)

#### ì†ŒìŠ¤
- **URL**: `https://comp.fnguide.com/SVO2/ASP/SVD_Main.asp?pGB=1&gicode=A{ì¢…ëª©ì½”ë“œ}`
- **ë°ì´í„°**: FnGuide ì• ë„ë¦¬ìŠ¤íŠ¸ ì»¨ì„¼ì„œìŠ¤
- **ê¸°ê°„**: ìµœê·¼ 4ê°œë…„ (2024-2027)

#### ìˆ˜ì§‘ í”„ë¡œì„¸ìŠ¤

```
1. ê¸°ì—… ëª©ë¡ ìˆ˜ì§‘
   â”œâ”€ Naver Finance ì‹œê°€ì´ì•¡ ìˆœìœ„ í˜ì´ì§€ í¬ë¡¤ë§
   â”œâ”€ KOSPI ìƒìœ„ 500ê°œ
   â”œâ”€ KOSDAQ ìƒìœ„ 500ê°œ
   â””â”€ ì´ ëª©í‘œ: 1,000ê°œ ê¸°ì—…

2. ê° ê¸°ì—…ë³„ ì¬ë¬´ ë°ì´í„° ìˆ˜ì§‘
   â”œâ”€ FnGuide í˜ì´ì§€ ì ‘ì†
   â”œâ”€ 11ë²ˆì§¸ í…Œì´ë¸” (ì¬ë¬´ì œí‘œ) íŒŒì‹±
   â”œâ”€ ìµœê·¼ 4ê°œë…„ ë°ì´í„° ì¶”ì¶œ
   â”‚   â”œâ”€ ë§¤ì¶œì•¡ (ì–µì› ë‹¨ìœ„)
   â”‚   â”œâ”€ ì˜ì—…ì´ìµ (ì–µì› ë‹¨ìœ„)
   â”‚   â””â”€ ì¶”ì •ì¹˜ ì—¬ë¶€ (E í‘œì‹œ í™•ì¸)
   â””â”€ ë‹¨ìœ„ ë³€í™˜: ì–µì› â†’ ì› (Ã— 100,000,000)

3. ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥
   â”œâ”€ companies í…Œì´ë¸” UPSERT
   â”‚   â””â”€ ì¢…ëª©ì½”ë“œ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µ ë°©ì§€
   â”œâ”€ financial_data í…Œì´ë¸” UPSERT
   â”‚   â””â”€ (company_id, year, scrape_date) ê¸°ì¤€
   â””â”€ ë°°ì¹˜ ì²˜ë¦¬: 50ê°œì”© ìˆœì°¨ ì²˜ë¦¬

4. ì—ëŸ¬ í•¸ë“¤ë§
   â”œâ”€ ë„¤íŠ¸ì›Œí¬ íƒ€ì„ì•„ì›ƒ: 5ì´ˆ
   â”œâ”€ íŒŒì‹± ì‹¤íŒ¨: ë¡œê·¸ ê¸°ë¡ í›„ ê³„ì†
   â””â”€ Rate Limiting: 500ms ë”œë ˆì´
```

#### í•µì‹¬ í•¨ìˆ˜ (lib/scraper.ts)

```typescript
// ê¸°ì—… ëª©ë¡ ìˆ˜ì§‘
export async function fetchTopStocks(
  market: 'KOSPI' | 'KOSDAQ', 
  limit: number = 500
) {
  // Naver Finance ì‹œê°€ì´ì•¡ ìˆœìœ„ì—ì„œ ìˆ˜ì§‘
  // í˜ì´ì§€ë‹¹ 50ê°œì”©, ìµœëŒ€ limitê°œê¹Œì§€
}

// ì¬ë¬´ ë°ì´í„° ìˆ˜ì§‘
export async function fetchFinancialData(stockCode: string) {
  // FnGuideì—ì„œ 11ë²ˆì§¸ í…Œì´ë¸” íŒŒì‹±
  // ë§¤ì¶œì•¡, ì˜ì—…ì´ìµ ì¶”ì¶œ
  // 4ê°œë…„ ë°ì´í„° ë°˜í™˜
}

// ë‹¨ìœ„ ë³€í™˜
export function parseAndScaleValue(value: string): number | null {
  // "1,234" â†’ 123,400,000,000 (ì–µì› â†’ ì›)
  return Math.round(numberValue * 100000000);
}
```

#### í˜„ì¬ ìˆ˜ì§‘ ìƒíƒœ

| í•­ëª© | ëª©í‘œ | ì‹¤ì œ | ìƒíƒœ |
|------|------|------|------|
| ì´ ê¸°ì—… ìˆ˜ | 1,000ê°œ | 1,788ê°œ | âœ… 178% ì´ˆê³¼ ë‹¬ì„± |
| ì¬ë¬´ ë ˆì½”ë“œ | ~4,000ê±´ | 135,241ê±´ | âœ… ì™„ë£Œ |
| í‰ê·  ê¸°ì—…ë‹¹ ë ˆì½”ë“œ | 4ê±´ | 75.6ê±´ | âœ… ìš°ìˆ˜ |
| ì»¤ë²„ë¦¬ì§€ | 100% | 1891% | âœ… ì´ˆê³¼ |

**í‰ê°€**: âœ… **ë§¤ìš° ìš°ìˆ˜** - ì¬ë¬´ ë°ì´í„° ìˆ˜ì§‘ì€ ëª©í‘œ ëŒ€ë¹„ 178% ì´ˆê³¼ ë‹¬ì„±

---

### 2.2 ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ (Naver Finance ê¸°ë°˜)

#### ì†ŒìŠ¤
- **URL**: `https://finance.naver.com/item/sise_day.naver?code={ì¢…ëª©ì½”ë“œ}&page={í˜ì´ì§€}`
- **ë°ì´í„°**: ì¼ë³„ ì‹œì„¸ (ì¢…ê°€, ë³€ë™ë¥ , ê±°ë˜ëŸ‰)
- **ê¸°ê°„**: ìµœê·¼ 120ì¼ (ì´í‰ì„  ê³„ì‚°ì— í•„ìš”)

#### ìˆ˜ì§‘ í”„ë¡œì„¸ìŠ¤

```
1. ë“±ë¡ëœ ì „ì²´ ê¸°ì—… ëª©ë¡ ë¡œë“œ
   â””â”€ companies í…Œì´ë¸”ì—ì„œ 1,788ê°œ ê¸°ì—… ì¡°íšŒ

2. ê° ê¸°ì—…ë³„ ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ (120ì¼ì¹˜)
   â”œâ”€ Naver Finance ì¼ë³„ ì‹œì„¸ í˜ì´ì§€ ì ‘ì†
   â”œâ”€ ìµœëŒ€ 6í˜ì´ì§€ ìˆœíšŒ (í˜ì´ì§€ë‹¹ ì•½ 20ì¼)
   â”œâ”€ ë°ì´í„° ì¶”ì¶œ
   â”‚   â”œâ”€ ë‚ ì§œ (2025.01.09 â†’ 2025-01-09)
   â”‚   â”œâ”€ ì¢…ê°€ (ì›)
   â”‚   â”œâ”€ ê±°ë˜ëŸ‰ (ì£¼)
   â”‚   â””â”€ ë³€ë™ë¥  (DBì—ì„œ ê³„ì‚°)
   â””â”€ Rate Limiting: 300ms í˜ì´ì§€ ê°„ ë”œë ˆì´

3. ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥
   â”œâ”€ daily_stock_prices í…Œì´ë¸” UPSERT
   â”‚   â””â”€ (company_id, date) ê¸°ì¤€
   â”œâ”€ ë°°ì¹˜ ì²˜ë¦¬: 50ê°œì”©
   â””â”€ ìë™ View ê°±ì‹  (ìˆ˜ì§‘ ì™„ë£Œ í›„)

4. ì—ëŸ¬ í•¸ë“¤ë§
   â”œâ”€ ë„¤íŠ¸ì›Œí¬ íƒ€ì„ì•„ì›ƒ: 5ì´ˆ
   â”œâ”€ ì¸ì½”ë”©: EUC-KR â†’ UTF-8
   â””â”€ íŒŒì‹± ì‹¤íŒ¨: ë¹ˆ ë°°ì—´ ë°˜í™˜
```

#### í•µì‹¬ í•¨ìˆ˜ (lib/scraper.ts)

```typescript
// ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ (120ì¼ì¹˜)
export async function fetchStockPrice(stockCode: string) {
  const priceData: Array<{
    date: string;
    close_price: number;
    change_rate: number | null;
    volume: number | null;
  }> = [];

  // ìµœëŒ€ 6í˜ì´ì§€ ìˆœíšŒ
  for (let page = 1; page <= 6 && priceData.length < 120; page++) {
    // Naver Finance í˜ì´ì§€ í¬ë¡¤ë§
    // ë‚ ì§œ, ì¢…ê°€, ê±°ë˜ëŸ‰ ì¶”ì¶œ
    // 300ms ë”œë ˆì´
  }

  return priceData; // ìµœëŒ€ 120ê°œ ë ˆì½”ë“œ
}
```

#### í˜„ì¬ ìˆ˜ì§‘ ìƒíƒœ

| í•­ëª© | ëª©í‘œ | ì‹¤ì œ | ìƒíƒœ |
|------|------|------|------|
| ì´ ê¸°ì—… ìˆ˜ | 1,788ê°œ | 19ê°œ | âŒ 1.1% |
| ì£¼ê°€ ë ˆì½”ë“œ | ~214,560ê±´ | 32,425ê±´ | âŒ 15.1% |
| í‰ê·  ê¸°ì—…ë‹¹ ë ˆì½”ë“œ | 120ì¼ | 1,707ì¼ | âš ï¸ ë¶ˆê· í˜• |
| 120ì¼ ì´í‰ì„  ë¶„ì„ ê°€ëŠ¥ | 1,788ê°œ | ~15ê°œ | âŒ 0.8% |

**í‰ê°€**: âŒ **ì‹¬ê°í•œ ë¬¸ì œ** - ì£¼ê°€ ë°ì´í„°ê°€ 19ê°œ ê¸°ì—…ì—ë§Œ ì§‘ì¤‘ ìˆ˜ì§‘ë¨

#### ë¬¸ì œ ì›ì¸ ë¶„ì„

```
í˜„ìƒ:
- 19ê°œ ê¸°ì—…: í‰ê·  1,707ì¼ì¹˜ ë°ì´í„° (ê³¼ë„ ìˆ˜ì§‘)
- 1,769ê°œ ê¸°ì—…: 0ì¼ì¹˜ ë°ì´í„° (ìˆ˜ì§‘ ì•ˆ ë¨)

ì›ì¸:
1. ë°°ì¹˜ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ê°€ ë™ì¼ ê¸°ì—…ì— ë°˜ë³µ ì‹¤í–‰
2. ê¸°ì—… ëª©ë¡ ë£¨í”„ê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•ŠìŒ
3. Cron Jobì´ ì „ì²´ ê¸°ì—…ì„ ìˆœíšŒí•˜ì§€ ëª»í•¨

í•´ê²° ë°©ì•ˆ:
â†’ Phase 1ì—ì„œ ë°°ì¹˜ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (100ê°œì”© 18ë°°ì¹˜)
```

---

## 3. ë°ì´í„° ì €ì¥ ìœ„ì¹˜ ë° í˜•ì‹

### 3.1 Supabase (PostgreSQL)

#### ìœ„ì¹˜
- **í˜¸ìŠ¤íŒ…**: Supabase Cloud
- **ë¦¬ì „**: Northeast Asia (Seoul)
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL 15
- **ì—°ê²°**: HTTPS REST API + PostgreSQL ì§ì ‘ ì—°ê²°

#### í™˜ê²½ë³€ìˆ˜
```bash
# .env.local (ë¡œì»¬ ê°œë°œ)
NEXT_PUBLIC_SUPABASE_URL=https://xxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJI...
SUPABASE_SERVICE_KEY=eyJhbGciOiJI...
CRON_SECRET=ëœë¤ë¬¸ìì—´
```

### 3.2 ë°ì´í„° í˜•ì‹

#### ì¬ë¬´ ë°ì´í„° ì˜ˆì‹œ

```json
{
  "company_id": 123,
  "year": 2024,
  "scrape_date": "2025-10-25",
  "revenue": 123400000000,        // 1,234ì–µì› (ì› ë‹¨ìœ„)
  "operating_profit": 45600000000, // 456ì–µì› (ì› ë‹¨ìœ„)
  "is_estimate": false
}
```

**ë‹¨ìœ„ ë³€í™˜ ê·œì¹™**:
- FnGuide ì›ë³¸: "1,234" (ì–µì›)
- ë°ì´í„°ë² ì´ìŠ¤: 123,400,000,000 (ì›)
- ë³€í™˜ ê³µì‹: `value Ã— 100,000,000`

#### ì£¼ê°€ ë°ì´í„° ì˜ˆì‹œ

```json
{
  "company_id": 123,
  "date": "2025-10-25",
  "close_price": 45600.00,  // ì›
  "change_rate": 2.34,       // %
  "volume": 1234567          // ì£¼
}
```

#### íˆ¬ì ê¸°íšŒ ë¶„ì„ ì˜ˆì‹œ

```json
{
  "company_id": 123,
  "name": "ì‚¼ì„±ì „ì",
  "code": "005930",
  "market": "KOSPI",
  "investment_score": 85,     // 0-100ì 
  "investment_grade": "Sê¸‰",   // S/A/B/C/D
  "consensus_score": 72,      // ì»¨ì„¼ì„œìŠ¤ ì ìˆ˜
  "divergence_score": 100,    // ì´ê²©ë„ ì ìˆ˜
  "current_price": 76000,
  "ma_120": 72000,
  "divergence_120": -5.26,    // -5.26% (ì €í‰ê°€)
  "revenue_change_1m": 8.5,   // +8.5% (ë§¤ì¶œ ì¦ê°€)
  "op_profit_change_1m": 12.3 // +12.3% (ì˜ì—…ìµ ì¦ê°€)
}
```

### 3.3 ìºì‹± ì „ëµ

#### í˜„ì¬ ìƒíƒœ
- âŒ **ìºì‹± ë¯¸êµ¬í˜„**
- âŒ ëª¨ë“  API ìš”ì²­ì´ DB ì§ì ‘ ì¿¼ë¦¬
- âŒ Materialized View ê°±ì‹ : ìˆ˜ë™

#### ë¬¸ì œì 
- í˜ì´ì§€ ë¡œë”© ëŠë¦¼
- DB ë¶€í•˜ ì¦ê°€
- Vercel Function ë¹„ìš© ì¦ê°€

#### ê°œì„  í•„ìš”
```typescript
// Phase 3ì—ì„œ êµ¬í˜„ ì˜ˆì •
// 1. Next.js Caching (revalidate)
export const revalidate = 60; // 1ë¶„ë§ˆë‹¤ ê°±ì‹ 

// 2. Materialized View ìë™ ê°±ì‹ 
// Cron Job: ë§¤ì¼ 21:00 (ì£¼ê°€ ìˆ˜ì§‘ í›„)
```

---

## 4. UI/UX êµ¬ì¡° ë° ì‚¬ìš©ì ê²½í—˜

### 4.1 í˜„ì¬ í˜ì´ì§€ êµ¬ì¡°

```
ğŸ“± YoonStock Pro (4ê°œ í˜ì´ì§€)
â”œâ”€ ğŸ  í™ˆí˜ì´ì§€ (/)
â”‚  â”œâ”€ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ìƒíƒœ
â”‚  â”œâ”€ ê¸°ë³¸ í†µê³„ ì¹´ë“œ (3ê°œ)
â”‚  â””â”€ ëŒ€ì‹œë³´ë“œ ë°”ë¡œê°€ê¸° ë²„íŠ¼ (3ê°œ)
â”‚
â”œâ”€ ğŸ“Š ëª¨ë‹ˆí„°ë§ (/monitor) â­ í•µì‹¬ í˜ì´ì§€
â”‚  â”œâ”€ ë°ì´í„° ìˆ˜ì§‘ í˜„í™© (4ê°œ ì¹´ë“œ)
â”‚  â”‚  â”œâ”€ ì´ ê¸°ì—… ìˆ˜
â”‚  â”‚  â”œâ”€ ì¬ë¬´ ë°ì´í„°
â”‚  â”‚  â”œâ”€ ì£¼ê°€ ë°ì´í„°
â”‚  â”‚  â””â”€ 120ì¼ ì´í‰ì„ 
â”‚  â”œâ”€ ìˆ˜ì§‘ ì§„í–‰ë¥  (í”„ë¡œê·¸ë ˆìŠ¤ ë°”)
â”‚  â”‚  â”œâ”€ ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ë¥ 
â”‚  â”‚  â””â”€ 120ì¼ ì´í‰ì„  ì¤€ë¹„ìœ¨
â”‚  â”œâ”€ ìµœê·¼ ìˆ˜ì§‘ ë‚ ì§œ
â”‚  â”œâ”€ ê¶Œì¥ ì‚¬í•­ ë° View ê°±ì‹  ë²„íŠ¼
â”‚  â””â”€ ìƒìœ„ íˆ¬ì ê¸°íšŒ Top 20 (í…Œì´ë¸”)
â”‚
â”œâ”€ ğŸ¯ íˆ¬ì ê¸°íšŒ (/opportunities)
â”‚  â”œâ”€ í•„í„°ë§ ì˜µì…˜
â”‚  â”‚  â”œâ”€ íˆ¬ì ë“±ê¸‰ (S/A/B/C/D)
â”‚  â”‚  â””â”€ ì •ë ¬ (íˆ¬ìì ìˆ˜/ì´ë¦„/ì½”ë“œ)
â”‚  â””â”€ íˆ¬ì ê¸°íšŒ í…Œì´ë¸”
â”‚     â”œâ”€ ë“±ê¸‰ (Sê¸‰/Aê¸‰/Bê¸‰/Cê¸‰/Dê¸‰)
â”‚     â”œâ”€ íˆ¬ì ì ìˆ˜ (0-100ì )
â”‚     â”œâ”€ ì»¨ì„¼ì„œìŠ¤ ì ìˆ˜
â”‚     â”œâ”€ ì´ê²©ë„ ì ìˆ˜
â”‚     â”œâ”€ í˜„ì¬ê°€ ë° ì´ê²©ë¥ 
â”‚     â””â”€ ì¬ë¬´ ë³€í™”ìœ¨
â”‚
â””â”€ ğŸ“‹ ì¬ë¬´ì œí‘œ (/dashboard)
   â”œâ”€ ì—°ë„ë³„ í•„í„°
   â”œâ”€ ì •ë ¬ ì˜µì…˜
   â”‚  â”œâ”€ ë§¤ì¶œì•¡ ì¦ê°ë¥ 
   â”‚  â””â”€ ì˜ì—…ì´ìµ ì¦ê°ë¥ 
   â””â”€ ì¬ë¬´ì œí‘œ í…Œì´ë¸”
      â”œâ”€ ì „ì¼/1ê°œì›”/3ê°œì›”/1ë…„ ì¦ê°ë¥ 
      â”œâ”€ ìœ ë§ ê¸°ì—… í•˜ì´ë¼ì´íŒ… (âœ¨)
      â””â”€ ê¸‰ë“± ê¸°ì—… í‘œì‹œ (ğŸ”¥)
```

### 4.2 UI ë¬¸ì œì  ìƒì„¸

#### âŒ ë¬¸ì œ 1: ë„¤ë¹„ê²Œì´ì…˜ ë¶€ì¬

**í˜„ìƒ**:
- í˜ì´ì§€ ê°„ ì´ë™ ë¶ˆí¸ (ë’¤ë¡œê°€ê¸° ë²„íŠ¼ë§Œ ì¡´ì¬)
- ì „ì²´ ë©”ë‰´ êµ¬ì¡° ë¶ˆëª…í™•
- í˜„ì¬ ìœ„ì¹˜ íŒŒì•… ì–´ë ¤ì›€

**ê°œì„  í•„ìš”**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [â˜° ë©”ë‰´]  YoonStock Pro         [ë¡œê·¸ì¸] [ì„¤ì •]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  ğŸ  í™ˆ                                           â”‚
â”‚  ğŸ“Š ëª¨ë‹ˆí„°ë§                                     â”‚
â”‚  ğŸ¯ íˆ¬ì ê¸°íšŒ                                    â”‚
â”‚  ğŸ“‹ ì¬ë¬´ì œí‘œ                                     â”‚
â”‚  ğŸ” ê¸°ì—… ê²€ìƒ‰                                    â”‚
â”‚  ğŸ“ˆ í¬íŠ¸í´ë¦¬ì˜¤                                   â”‚
â”‚  âš™ï¸ ì„¤ì •                                         â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### âŒ ë¬¸ì œ 2: í•„í„°ë§ ê¸°ëŠ¥ ì•½í•¨

**í˜„ì¬ í•„í„°**:
- âœ… íˆ¬ì ë“±ê¸‰ (S/A/B/C/D)
- âŒ ì‹œì¥ êµ¬ë¶„ (KOSPI/KOSDAQ) - ì—†ìŒ
- âŒ ì—…ì¢…ë³„ - ì—†ìŒ
- âŒ ì‹œê°€ì´ì•¡ ë²”ìœ„ - ì—†ìŒ
- âŒ ì£¼ê°€ ë²”ìœ„ - ì—†ìŒ
- âŒ ì´ê²©ë„ ë²”ìœ„ - ì—†ìŒ

**ê°œì„  í•„ìš”**:
```typescript
interface FilterOptions {
  market: 'ALL' | 'KOSPI' | 'KOSDAQ';
  investmentGrade: 'ALL' | 'S' | 'A' | 'B' | 'C' | 'D';
  sector?: string[];  // ì‹ ê·œ ì¶”ê°€
  marketCapRange?: [number, number];  // ì‹œê°€ì´ì•¡ ë²”ìœ„
  priceRange?: [number, number];      // ì£¼ê°€ ë²”ìœ„
  divergenceRange?: [number, number]; // ì´ê²©ë„ ë²”ìœ„ (-20% ~ +20%)
  minScore?: number;  // ìµœì†Œ íˆ¬ì ì ìˆ˜
}
```

#### âŒ ë¬¸ì œ 3: ë°ì´í„° ì‹œê°í™” ë¶€ì¡±

**í˜„ì¬**:
- ì°¨íŠ¸ 0ê°œ (í…Œì´ë¸”ë§Œ ì¡´ì¬)
- íŠ¸ë Œë“œ íŒŒì•… ì–´ë ¤ì›€
- ë¹„êµ ë¶„ì„ ë¶ˆê°€

**ê°œì„  í•„ìš”** (Phase 3ì—ì„œ êµ¬í˜„):
1. **ì£¼ê°€ ì¶”ì„¸ ì°¨íŠ¸** (Line Chart)
   - 120ì¼ ì´í‰ì„  + í˜„ì¬ ì£¼ê°€
   - ì´ê²©ë„ í‘œì‹œ
2. **ì»¨ì„¼ì„œìŠ¤ ë³€í™” ì°¨íŠ¸** (Bar Chart)
   - ë§¤ì¶œì•¡/ì˜ì—…ì´ìµ ë³€í™”ìœ¨ ë¹„êµ
3. **íˆ¬ì ê¸°íšŒ ë¶„í¬ë„** (Scatter Plot)
   - Xì¶•: ì»¨ì„¼ì„œìŠ¤ ì ìˆ˜
   - Yì¶•: ì´ê²©ë„ ì ìˆ˜
4. **ì„¹í„°ë³„ ë¶„í¬** (Pie Chart)
   - íˆ¬ì ë“±ê¸‰ë³„ ê¸°ì—… ìˆ˜

#### âŒ ë¬¸ì œ 4: ë°˜ì‘í˜• ë””ìì¸ ë¯¸í¡

**í˜„ì¬**:
- í…Œì´ë¸” ê°€ë¡œ ìŠ¤í¬ë¡¤ ë¶ˆí¸ (ëª¨ë°”ì¼)
- ëª¨ë°”ì¼ ë©”ë‰´ ì—†ìŒ
- í„°ì¹˜ ì œìŠ¤ì²˜ ë¯¸ì§€ì›

---

## 5. í•µì‹¬ ë¬¸ì œì  ë° í•´ê²° ë°©ì•ˆ

### 5.1 ë¬¸ì œ ìš°ì„ ìˆœìœ„

| ìˆœìœ„ | ë¬¸ì œ | ì˜í–¥ë„ | í•´ê²° ë‚œì´ë„ | ì˜ˆìƒ ì‹œê°„ |
|------|------|--------|------------|----------|
| **1** | ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ ë¶ˆì™„ì „ (1.1%) | ğŸ”´ Critical | ğŸŸ¢ ì‰¬ì›€ | 1-2ì¼ |
| **2** | UI/UX ë¶ˆí¸í•¨ (ë„¤ë¹„ê²Œì´ì…˜ ë¶€ì¬) | ğŸŸ  High | ğŸŸ¡ ì¤‘ê°„ | 2ì£¼ |
| **3** | ë°ì´í„° ì •í™•ì„± ë¯¸ê²€ì¦ | ğŸŸ  High | ğŸŸ¡ ì¤‘ê°„ | 1ì£¼ |
| **4** | ì„±ëŠ¥ ìµœì í™” ë¶€ì¡± (ìºì‹±) | ğŸŸ¡ Medium | ğŸŸ¢ ì‰¬ì›€ | 3ì¼ |
| **5** | ëª¨ë°”ì¼ ìµœì í™” ë¯¸í¡ | ğŸŸ¡ Medium | ğŸŸ¡ ì¤‘ê°„ | 1ì£¼ |

### 5.2 ë¬¸ì œ 1: ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ ë¶ˆì™„ì „ (ìµœìš°ì„ )

#### í˜„ìƒ
```
ì´ 1,788ê°œ ê¸°ì—… ì¤‘:
- 19ê°œ ê¸°ì—…: í‰ê·  1,707ì¼ì¹˜ ë°ì´í„° (ê³¼ë„ ìˆ˜ì§‘)
- 1,769ê°œ ê¸°ì—…: 0ì¼ì¹˜ ë°ì´í„° (ìˆ˜ì§‘ ì•ˆ ë¨)
```

#### ì˜í–¥
- âŒ íˆ¬ì ê¸°íšŒ ë¶„ì„ ì‹œìŠ¤í…œ 99% ì‘ë™ ë¶ˆê°€
- âŒ 120ì¼ ì´í‰ì„  ë¶„ì„ 0.8%ë§Œ ê°€ëŠ¥
- âŒ Sê¸‰/Aê¸‰ ê¸°ì—… ë°œêµ´ ë¶ˆê°€ëŠ¥
- âŒ ì„œë¹„ìŠ¤ ê°€ì¹˜ ì œê³µ ë¶ˆê°€

#### í•´ê²° ë°©ì•ˆ (Phase 1)
```bash
# 1. ë°°ì¹˜ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (100ê°œì”© 18ë°°ì¹˜)
bash scripts/collect-all-batches.sh

# 2. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
open http://localhost:3000/monitor

# 3. View ê°±ì‹ 
curl -X POST http://localhost:3000/api/refresh-views

# 4. ë°ì´í„° ê²€ì¦
curl http://localhost:3000/api/data-status > after.json
```

#### ì˜ˆìƒ ê²°ê³¼
```
Before:
- ì£¼ê°€ ë ˆì½”ë“œ: 32,425ê±´ (1.1%)
- ë¶„ì„ ê°€ëŠ¥ ê¸°ì—…: 19ê°œ (1.1%)
- íˆ¬ì ê¸°íšŒ ë°œê²¬: ë¶ˆê°€ëŠ¥

After:
- ì£¼ê°€ ë ˆì½”ë“œ: 214,560ê±´ (100%) â†‘ 6.6ë°°
- ë¶„ì„ ê°€ëŠ¥ ê¸°ì—…: 1,788ê°œ (100%) â†‘ 94ë°°
- íˆ¬ì ê¸°íšŒ ë°œê²¬: Sê¸‰ 5-10ê°œ, Aê¸‰ 10-20ê°œ
```

---

## 6. ë‹¨ê³„ë³„ ê°œì„  ì‹¤í–‰ ê³„íš

### ğŸ”´ Phase 1: ë°ì´í„° ìˆ˜ì§‘ ì™„ì „ì„± í™•ë³´ (1-2ì¼) â­ ìµœìš°ì„ 

#### ëª©í‘œ
ì „ì²´ 1,788ê°œ ê¸°ì—…ì˜ ì£¼ê°€ ë°ì´í„° 100% ìˆ˜ì§‘

#### ì‘ì—… ë‚´ì—­

**Day 1 (ì˜¤ëŠ˜)**:
1. âœ… í™˜ê²½ë³€ìˆ˜ í™•ì¸
   ```bash
   cd /home/user/webapp && cat .env.local
   ```

2. âœ… ë¡œì»¬ ê°œë°œ ì„œë²„ ì‹¤í–‰
   ```bash
   cd /home/user/webapp && npm run dev
   ```

3. âœ… ë°ì´í„° ìŠ¤ëƒ…ìƒ· ì €ì¥ (Before)
   ```bash
   curl http://localhost:3000/api/data-status > data-snapshot-before.json
   ```

4. âœ… ë°°ì¹˜ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
   ```bash
   bash scripts/collect-all-batches.sh
   # ì´ 18ë°°ì¹˜ Ã— 100ê°œ = 1,800ê°œ ê¸°ì—…
   # ì˜ˆìƒ ì†Œìš” ì‹œê°„: 4-8ì‹œê°„
   ```

5. âœ… ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
   - http://localhost:3000/monitor
   - ìˆ˜ì§‘ ì§„í–‰ë¥  í™•ì¸
   - ì—ëŸ¬ ë¡œê·¸ ëª¨ë‹ˆí„°ë§

**Day 2 (ë‚´ì¼)**:
1. âœ… ë°ì´í„° ê²€ì¦
   ```bash
   curl http://localhost:3000/api/data-status > data-snapshot-after.json
   diff data-snapshot-before.json data-snapshot-after.json
   ```

2. âœ… View ê°±ì‹ 
   ```bash
   curl -X POST http://localhost:3000/api/refresh-views
   ```

3. âœ… íˆ¬ì ê¸°íšŒ ë¶„ì„ í…ŒìŠ¤íŠ¸
   ```bash
   curl http://localhost:3000/api/investment-opportunities?limit=50
   ```

4. âœ… ìƒ˜í”Œ ê¸°ì—… ê²€ì¦ (10ê°œ)
   - ì‚¼ì„±ì „ì (005930)
   - SKí•˜ì´ë‹‰ìŠ¤ (000660)
   - ë„¤ì´ë²„ (035420)
   - ì¹´ì¹´ì˜¤ (035720)
   - LGì—ë„ˆì§€ì†”ë£¨ì…˜ (373220)
   - í˜„ëŒ€ì°¨ (005380)
   - ê¸°ì•„ (000270)
   - í¬ìŠ¤ì½”í™€ë”©ìŠ¤ (005490)
   - KBê¸ˆìœµ (105560)
   - ì‚¼ì„±ë°”ì´ì˜¤ë¡œì§ìŠ¤ (207940)

#### ì„±ê³µ ê¸°ì¤€
- [x] ì£¼ê°€ ë°ì´í„°: 214,560ê±´ ì´ìƒ (1,788 Ã— 120)
- [x] ì»¤ë²„ë¦¬ì§€: 100% (1,788ê°œ ê¸°ì—…)
- [x] 120ì¼ ì¤€ë¹„ìœ¨: 100%
- [x] ë°ì´í„° í’ˆì§ˆ: 99% ì´ìƒ

#### Git ì»¤ë°‹
```bash
cd /home/user/webapp
git add .
git commit -m "feat: ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ (Phase 1)

- 1,788ê°œ ê¸°ì—… 100% ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ
- ì´ 214,560ê±´ ì´ìƒ ë ˆì½”ë“œ í™•ë³´
- 120ì¼ ì´í‰ì„  ë¶„ì„ ê°€ëŠ¥ ìƒíƒœ
- íˆ¬ì ê¸°íšŒ ë¶„ì„ ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™"
```

---

### ğŸŸ  Phase 2: ë°ì´í„° ì •í™•ì„± ê²€ì¦ (1ì£¼)

#### ëª©í‘œ
ìˆ˜ì§‘ëœ ë°ì´í„°ì˜ ì •í™•ì„± 100% ê²€ì¦

#### ì‘ì—… ë‚´ì—­

**1. ì¬ë¬´ ë°ì´í„° ê²€ì¦**
- [ ] FnGuide ì›ë³¸ ë°ì´í„°ì™€ ë¹„êµ (ìƒ˜í”Œ 100ê°œ)
- [ ] ë‹¨ìœ„ ë³€í™˜ ë¡œì§ ì¬í™•ì¸ (ì–µì› â†’ ì›)
- [ ] ì¶”ì •ì¹˜ í”Œë˜ê·¸ ì •í™•ì„± ê²€ì¦
- [ ] ì´ìƒì¹˜ íƒì§€ ë° í•„í„°ë§

**2. ì£¼ê°€ ë°ì´í„° ê²€ì¦**
- [ ] Naver Financeì™€ ë‚ ì§œë³„ ë¹„êµ (ìƒ˜í”Œ 100ê°œ)
- [ ] ë³€ë™ë¥  ê³„ì‚° ë¡œì§ ê²€ì¦
- [ ] ê±°ë˜ëŸ‰ ì •í•©ì„± í™•ì¸
- [ ] ì´ìƒì¹˜ íƒì§€ (ê·¹ë‹¨ê°’ í•„í„°ë§)

**3. ë¶„ì„ ë¡œì§ ê²€ì¦**
- [ ] 120ì¼ ì´í‰ì„  ê³„ì‚° ìˆ˜ì‹ í™•ì¸
- [ ] ì´ê²©ë„ ê³„ì‚° ë¡œì§ ê²€ì¦
- [ ] ì»¨ì„¼ì„œìŠ¤ ë³€í™”ìœ¨ ê³„ì‚° ê²€ì¦
- [ ] íˆ¬ì ì ìˆ˜ ì•Œê³ ë¦¬ì¦˜ ê²€ì¦

**4. ìë™í™” í…ŒìŠ¤íŠ¸ ì‘ì„±**
```typescript
// tests/data-validation.test.ts
describe('ë°ì´í„° ì •í™•ì„± ê²€ì¦', () => {
  test('ì¬ë¬´ ë°ì´í„° ë‹¨ìœ„ ë³€í™˜', () => {
    expect(parseAndScaleValue("1,234")).toBe(123400000000);
  });

  test('120ì¼ ì´í‰ì„  ê³„ì‚°', () => {
    const prices = [/* 120ê°œ ê°€ê²© */];
    const ma120 = calculateMA120(prices);
    expect(ma120).toBeCloseTo(expectedValue);
  });

  test('íˆ¬ì ì ìˆ˜ ê³„ì‚°', () => {
    const score = calculateInvestmentScore({
      consensus_score: 70,
      divergence_score: 80
    });
    expect(score).toBe(74); // 70*0.6 + 80*0.4
  });
});
```

#### ì„±ê³µ ê¸°ì¤€
- ë°ì´í„° ì •í™•ë„: 99.9% ì´ìƒ
- ì´ìƒì¹˜: < 0.1%
- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤: 100ê°œ ê¸°ì—… í†µê³¼

---

### ğŸ”´ Phase 3: UI/UX ëŒ€ëŒ€ì  ê°œì„  (2ì£¼)

#### ëª©í‘œ
ì™¼ìª½ ì‚¬ì´ë“œë°” + ê³ ê¸‰ í•„í„°ë§ + ì°¨íŠ¸ ì‹œê°í™”

#### ì‘ì—… ë‚´ì—­

**Week 1: ì™¼ìª½ ì‚¬ì´ë“œë°” ë° í•„í„°ë§**

1. **ì™¼ìª½ ì‚¬ì´ë“œë°” êµ¬í˜„**
   ```typescript
   // app/components/Sidebar.tsx
   export default function Sidebar() {
     return (
       <aside className="w-64 bg-white border-r fixed h-screen">
         <div className="p-6">
           <h1 className="text-2xl font-bold">YoonStock Pro</h1>
         </div>
         <nav className="mt-6">
           <NavGroup title="ëŒ€ì‹œë³´ë“œ">
             <NavItem icon="ğŸ " label="í™ˆ" href="/" />
             <NavItem icon="ğŸ“Š" label="ëª¨ë‹ˆí„°ë§" href="/monitor" />
             <NavItem icon="ğŸ¯" label="íˆ¬ì ê¸°íšŒ" href="/opportunities" />
             <NavItem icon="ğŸ“‹" label="ì¬ë¬´ì œí‘œ" href="/dashboard" />
           </NavGroup>
           <NavGroup title="ë¶„ì„ ë„êµ¬">
             <NavItem icon="ğŸ”" label="ê¸°ì—… ê²€ìƒ‰" href="/search" />
             <NavItem icon="ğŸ“ˆ" label="ì„¹í„° ë¶„ì„" href="/sectors" />
           </NavGroup>
         </nav>
       </aside>
     );
   }
   ```

2. **ê³ ê¸‰ í•„í„°ë§ ì‹œìŠ¤í…œ**
   ```typescript
   // app/components/FilterPanel.tsx
   export default function FilterPanel() {
     return (
       <div className="bg-white rounded-lg shadow-md p-6">
         <h3 className="text-lg font-bold mb-4">í•„í„° ì˜µì…˜</h3>
         
         {/* ì‹œì¥ êµ¬ë¶„ */}
         <FilterSection title="ì‹œì¥">
           <Radio value="ALL" label="ì „ì²´" />
           <Radio value="KOSPI" label="KOSPI" />
           <Radio value="KOSDAQ" label="KOSDAQ" />
         </FilterSection>

         {/* íˆ¬ì ë“±ê¸‰ */}
         <FilterSection title="íˆ¬ì ë“±ê¸‰">
           <Checkbox value="S" label="Sê¸‰" />
           <Checkbox value="A" label="Aê¸‰" />
           <Checkbox value="B" label="Bê¸‰" />
         </FilterSection>

         {/* ì‹œê°€ì´ì•¡ ë²”ìœ„ */}
         <FilterSection title="ì‹œê°€ì´ì•¡">
           <RangeSlider 
             min={0} 
             max={100000000000000} 
             step={1000000000000}
           />
         </FilterSection>

         {/* ì´ê²©ë„ ë²”ìœ„ */}
         <FilterSection title="ì´ê²©ë„">
           <RangeSlider min={-20} max={20} step={1} />
         </FilterSection>
       </div>
     );
   }
   ```

**Week 2: ì°¨íŠ¸ ì‹œê°í™” ë° ë°˜ì‘í˜•**

3. **Recharts ë„ì… ë° ì°¨íŠ¸ êµ¬í˜„**
   ```bash
   npm install recharts
   ```

   ```typescript
   // app/components/charts/PriceTrendChart.tsx
   import { LineChart, Line, XAxis, YAxis, Tooltip, Legend } from 'recharts';

   export default function PriceTrendChart({ data }) {
     return (
       <LineChart width={800} height={400} data={data}>
         <XAxis dataKey="date" />
         <YAxis />
         <Tooltip />
         <Legend />
         <Line type="monotone" dataKey="close_price" stroke="#3b82f6" name="ì¢…ê°€" />
         <Line type="monotone" dataKey="ma_120" stroke="#f59e0b" name="120ì¼ ì´í‰ì„ " />
       </LineChart>
     );
   }
   ```

4. **ë°˜ì‘í˜• ë””ìì¸**
   - ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜
   - í„°ì¹˜ ì œìŠ¤ì²˜ ì§€ì›
   - íƒœë¸”ë¦¿ ìµœì í™”

#### ì„±ê³µ ê¸°ì¤€
- í˜ì´ì§€ ë¡œë”©: < 2ì´ˆ
- ëª¨ë°”ì¼ ìµœì í™”: ì™„ë£Œ
- ì°¨íŠ¸: 5ê°œ ì´ìƒ êµ¬í˜„

---

### ğŸŸ¡ Phase 4: ë°±ì—”ë“œ Cron Job ìµœì í™” (1ì£¼)

#### ëª©í‘œ
ì•ˆì •ì ì´ê³  íš¨ìœ¨ì ì¸ ìë™ ìˆ˜ì§‘

#### ì‘ì—… ë‚´ì—­

1. **ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”**
   ```typescript
   // lib/scraper-enhanced.ts
   async function fetchWithRetry(url: string, maxRetries = 3) {
     for (let i = 0; i < maxRetries; i++) {
       try {
         const response = await fetch(url, { timeout: 5000 });
         if (response.ok) return response;
       } catch (error) {
         if (i === maxRetries - 1) throw error;
         await delay(1000 * (i + 1)); // ì§€ìˆ˜ ë°±ì˜¤í”„
       }
     }
   }
   ```

2. **ìˆ˜ì§‘ ìŠ¤ì¼€ì¤„ ìµœì í™”**
   ```json
   // vercel.json
   {
     "crons": [
       {
         "path": "/api/collect-data",
         "schedule": "0 14 * * 0"  // ì£¼ 1íšŒ (ì¼ìš”ì¼ 23:00 KST)
       },
       {
         "path": "/api/collect-stock-prices",
         "schedule": "0 11 * * 1-5"  // í‰ì¼ 20:00 KST
       },
       {
         "path": "/api/refresh-views",
         "schedule": "0 12 * * 1-5"  // í‰ì¼ 21:00 KST
       }
     ]
   }
   ```

3. **ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶•**
   - Sê¸‰ ê¸°ì—… ë°œê²¬ ì‹œ ì´ë©”ì¼ ì•Œë¦¼
   - ìˆ˜ì§‘ ì‹¤íŒ¨ ì‹œ Slack ì•Œë¦¼

---

### ğŸŸ¡ Phase 5: Vercel í”„ë¡œë•ì…˜ ë°°í¬ (1ì¼)

#### ì‘ì—… ë‚´ì—­

1. **í™˜ê²½ë³€ìˆ˜ ì„¤ì •**
   - Vercel Dashboard â†’ Settings â†’ Environment Variables
   - 4ê°œ í™˜ê²½ë³€ìˆ˜ ì¶”ê°€

2. **Vercel Cron í™œì„±í™”**
   - vercel.json ì„¤ì • í™•ì¸
   - Cron Job í™œì„±í™”

3. **ëª¨ë‹ˆí„°ë§ ì„¤ì •**
   - Vercel Analytics
   - Sentry í†µí•©

---

## ğŸ“Š ì˜ˆìƒ ì„±ê³¼ ë° íƒ€ì„ë¼ì¸

### Phase 1 ì™„ë£Œ í›„ (1-2ì¼)

**Before**:
```
ì£¼ê°€ ë°ì´í„°: 32,425ê±´ (1.1%)
ë¶„ì„ ê°€ëŠ¥ ê¸°ì—…: 19ê°œ (1.1%)
íˆ¬ì ê¸°íšŒ ë°œê²¬: ë¶ˆê°€ëŠ¥
ì„œë¹„ìŠ¤ ê°€ì¹˜: ê±°ì˜ ì—†ìŒ
```

**After**:
```
ì£¼ê°€ ë°ì´í„°: 214,560ê±´ (100%) â†‘ 6.6ë°°
ë¶„ì„ ê°€ëŠ¥ ê¸°ì—…: 1,788ê°œ (100%) â†‘ 94ë°°
íˆ¬ì ê¸°íšŒ ë°œê²¬: Sê¸‰ 5-10ê°œ, Aê¸‰ 10-20ê°œ
ì„œë¹„ìŠ¤ ê°€ì¹˜: ì¦‰ì‹œ ë¡ ì¹­ ê°€ëŠ¥
```

### ì „ì²´ íƒ€ì„ë¼ì¸

| Phase | ì‘ì—… ë‚´ìš© | ê¸°ê°„ | ì‹œì‘ì¼ | ì™„ë£Œ ëª©í‘œì¼ |
|-------|----------|------|--------|------------|
| Phase 1 | ë°ì´í„° ìˆ˜ì§‘ ì™„ì „ì„± | 1-2ì¼ | 2025-10-25 | 2025-10-26 |
| Phase 2 | ë°ì´í„° ì •í™•ì„± ê²€ì¦ | 1ì£¼ | 2025-10-27 | 2025-11-02 |
| Phase 3 | UI/UX ê°œì„  | 2ì£¼ | 2025-11-03 | 2025-11-16 |
| Phase 4 | Cron Job ìµœì í™” | 1ì£¼ | 2025-11-17 | 2025-11-23 |
| Phase 5 | Vercel ë°°í¬ | 1ì¼ | 2025-11-24 | 2025-11-24 |

**ì´ ì˜ˆìƒ ê¸°ê°„**: ì•½ 5ì£¼

---

## ğŸ¯ ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ ì•¡ì…˜ ì•„ì´í…œ

### ì˜¤ëŠ˜ ë‹¹ì¥ (2ì‹œê°„)

1. âœ… í™˜ê²½ë³€ìˆ˜ í™•ì¸
2. âœ… ë¡œì»¬ ê°œë°œ ì„œë²„ ì‹¤í–‰
3. âœ… ë°ì´í„° ìŠ¤ëƒ…ìƒ· ì €ì¥
4. âœ… ë°°ì¹˜ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œì‘

### ë‚´ì¼ (4-8ì‹œê°„)

1. âœ… ë°ì´í„° ê²€ì¦
2. âœ… View ê°±ì‹ 
3. âœ… íˆ¬ì ê¸°íšŒ ë¶„ì„ í…ŒìŠ¤íŠ¸
4. âœ… Git ì»¤ë°‹ ë° PR ìƒì„±

---

**ë³´ê³ ì„œ ì‘ì„± ì™„ë£Œ**: 2025-10-25  
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: Phase 1 ì™„ë£Œ í›„ ê²°ê³¼ ë³´ê³ 

**ì‘ì„±ì**: ì „ë¬¸ ê°œë°œì ë¶„ì„íŒ€  
**ì—°ë½ì²˜**: GitHub Issues (https://github.com/Badmin-on/dailystockdata/issues)
